# 2026-01-26 Session Notes

## CRM Project Work (Major Session)

### Setup & Infrastructure
- Installed PostgreSQL on Peter's Ubuntu machine
- Set up passwordless sudo for easier system management
- Configured cloudflare tunnels for public URL access (trycloudflare.com)
- Gmail OAuth credentials configured for CRM

### Email Campaign Threading Feature
- Added `thread_mode` column to campaigns ('new' | 'reply')
- Added `selected_thread_id` for per-recipient thread selection
- **Key fix**: Reply mode now uses "Re: [original subject]" instead of template subject
- Fixed both `sendCampaign` and `sendSingleRecipient` functions
- Preview shows full email history with selectable threads

### Campaign Name Validation
- Added unique constraint on campaign names per user
- Live validation as you type (debounced 300ms)
- Red outline/text feedback for duplicate names
- Fixed route ordering issue (`/check-name` must be before `/:id` routes)

### UI Fixes
- Fixed navbar invisible on landing page in light mode (ios-theme.css was overriding)
- Fixed form-row alignment when labels have different heights

### System Config
- PC configured to never auto-sleep/suspend (user request)
- KDE power settings updated

## Key Commits
- Backend: `5851386` (feature/gmail-integration-2.0)
- Frontend: `73376f1e` (feature/gmail-integration-2.0)

## Notes
- Peter accesses CRM via http://localhost:3000 for local dev
- Gmail OAuth requires localhost callback (Google blocks private IPs)
- Work PC firewall blocks trycloudflare.com ("hosting" category)
